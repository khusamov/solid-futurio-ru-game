История разработки
==================

2022-05-20
----------

Оказывается на тело воздействуют две силы: сила для поступательного движения и для вращательного. 
И вычислять их надо отдельно друг от друга.

Момент силы оказывается это векторное произведение. По-началу это ускользало из внимания. 
Пришлось добавить класс Vector3.

Вычисление плеча для приложения силы вращения оказалось снова неправильным. Пришлось исправить
и добавить код пока без упрощений.

Подсистему добавления управления с клавиатуры надо переделать. Иначе нельзя изменить управление кораблем
с изменения сил двигателей на включение-выключение двигателей. Это архитектурная ошибка.

Похоже пакет khusamov-mechanical-motion завершен. Если не считать что нужно по хорошому вычислять:
центр масс, сумму моментов силы, сумму моментов инерции и тому подобное.

2022-05-13
----------

Упрощение кода продолжается.

Начал отказываться от `export default`.

В пакетах `khusamov-command-order-system` и `khusamov-inversion-of-control`
добавлено модульное тестирование на основе `Mocha` и `Chai`.

Пакеты `khusamov-format-code`, `khusamov-adapter-generator`, `khusamov-adapter-generator-runtime` и 
`khusamov-rollup-config` законсервированы и будут перемещены в иные репозитории.

Полностью отказался от `typescript-rtti`. Очень жаль, но из-за него разработка сильно тормозит. 
Причем перспективы туманны.

Вернулся обратно на сборку через `Parcel`:
- Начали работать файлы `*.js.map` и теперь доступны исходные тексты в браузере.
- Выявились ошибки, которые почему-то прощались при `Rollup`. Но их легко исправить.
- Пришлось добавить инструкции `export type` из-за опции `isolatedModules`. 
  Надо заметить, эта ошибка проявляется в генерации сообщений при сборке следующего вида `does not export default`. 
  В итоге не сразу стало понятно что именно отсутствие `export type` влияет на это.
  IDE не сразу эту ошибку показало, только после ее перезагрузки (на следующий день).


2022-05-12
----------

Окончательно распрощался с пакетом typescript-rtti. Автор конечно активный, но проект очень сырой.
Постоянно добавляет проблем. Но перспектива у проекта есть конечно. Итак недостатки:
- Трансформер для TypeScript сильно мусорит выходной код. 
- Проект не доделан. И имеет баги.
- Подходит только для Rollup. 
- При сборке в Rollup много ошибок и предупреждений, но они не влияют пока не работоспособность.
- Последний раз в лог начал выводиться исходные скомпилированный код без ошибок. Это приводило к вылету или подвисанию.

В общем последний недостаток и дал повод окончательно отказаться от этого пакета.

Переходим обратно на parcel. Наработки по Rollup переносим на khusamov.github.io в виде статей.

Генератор адаптеров в файлы khusamov-adapter-generator не доделан. Работы в нем гораздо больше чем, 
если это делать на основе typescript-rtti. Поэтому эта работа откладывается до момента, когда это реально
будет нужно. Его придется перенести в отдельный репозиторий и законсервировать до лучших времен.

2022-04-23
----------

Автор `typescript-rtti` исправил ошибку: https://github.com/typescript-rtti/typescript-rtti/issues/56

Обновил `typescript-rtti` до `0.6.0` и ошибка действительно пропала. Сейчас тестовый пример отрабатывает все верно.

Также был сделан генератор адаптера `khusamov-adapter-generator`. Если с `typescript-rtti` опять не заладится,
то можно будет воспользоваться генератором. Но пока в этом нет острой необходимости.

2022-04-21
----------

Написана функция `getDeclarationFilename()` (спасибо за помощь https://vk.com/debagger), 
но проблема не решена.
Функция возвращает строку вида:

```
/Users/khusamov/Documents/repo/github.com/khusamov/solid-futurio-ru-game/packages/khusamov-base-types/dist/types/Vector.d.ts
```

Вопрос, как ее преобразовать в правильный импорт?

```typescript
import Vector from 'khusamov-base-types'
```

Выделить `khusamov-base-types` из пути не реально.


2022-04-20
----------

Написана первая версия генератора адаптеров на основе [TypeScript Compiler API][compiler]. 
См. пакет `packages/khusamov-adapter-generator`.

Задача генерации адаптера решена, но задача написания кодо-генератора в общем виде оказалось 
сложной из-за отсутствия документации на `Compiler API`. В итоге можно застрять в любой момент
при попытке расширить возможности генератора. В этом плане `Reflection` куда более привлекателен,
так как там все зависит от автора `typescript-rtti`, который пока активно разрабатывает свой проект.

[compiler]: https://github.com/Microsoft/TypeScript/wiki/Using-the-Compiler-API